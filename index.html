<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <title>Document</title>
</head>
<body>
    
    <h1>Mande sua mensagem</h1>

    <p>Nome:</p>
    <input id="nome" type="text">
    <p>mensagem</p>

    <input id="recado"type="text">
    <button type="submit" onclick="AtualizarMensagens()">Enviar</button>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAAqeqKW2daXvAGs3qIB6rTFd_I22pNve0",
        authDomain: "mandarmsg-eb7a5.firebaseapp.com",
        projectId: "mandarmsg-eb7a5",
        storageBucket: "mandarmsg-eb7a5.appspot.com",
        messagingSenderId: "326553069341",
        appId: "1:326553069341:web:7ce78aff257129717a23f4",
        measurementId: "G-Z9FEVC6Q83"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const bd = firebase.firestore()



    mensagens = new Object()
    let totalMensagens = [0]
    const id = "5Y0zOwSIh0F8J9IY31vJ"
    
    bd.collection('Mensagens').doc(id).onSnapshot(function (doc){
            
            if(doc.exists){
                
                const dados = doc.data()
                
                totalMensagens[0] = dados.TotaldeMensagens
                console.log(totalMensagens[0])

            }
            else{
                console.log('nÃ£o existe')
            }
    })

function AtualizarMensagens(){
	
	alert('Mensagem Enviada')

    const inputNome = document.getElementById("nome").value
    const inputRecado = document.getElementById("recado").value
    

    totalMensagens[0]++

    let objectIndex = `recado${totalMensagens}` 
    
    mensagens[objectIndex] = `${inputNome}-${inputRecado}`;
    console.log(mensagens)

    bd.collection('Mensagens').doc(id).update(mensagens).then(() => {
        console.log(' adicionado')
    }).catch((error) => {
    console.error(error)
    })
    
    bd.collection('Mensagens').doc(id).update({
        TotaldeMensagens: totalMensagens[0]
    }).then(() => {
        console.log(' adicionado')
    }).catch((error) => {
    console.error(error)
    })

}

    


</script>
</body>
</html>
